explain
delete from
  ticket_actions
where
  ticket in (
    select
      pkey
    from
      tickets
    where
      ticket_type='logs'
      and open_date<(now()-'15 minutes'::interval)
  ) and time<(now()-'15 minutes'::interval)
;
vacuum full verbose analyze ticket_actions;
reindex table ticket_actions;



explain
delete from
  tickets
where
  ticket_type='logs'
  and open_date<(now()-'15 minutes'::interval)
  and (select pkey from ticket_actions ta where tickets.pkey=ta.ticket limit 1) is null
;
vacuum full verbose analyze tickets;
reindex table tickets;
